<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rialo Snake (Logo Edition)</title>
<style>
:root{
  --bg-cream:#f5f5dc;
  --accent:#111;
  --muted:#555;
}
html, body {
  height: 100%;
  margin: 0;
  font-family: Inter, ui-sans-serif, system-ui, Segoe UI, Roboto, 'Helvetica Neue', Arial;
  background: var(--bg-cream);
  color: #111;
  display: flex;
  justify-content: center;
  align-items: center;
}

.wrap {
  width: min(960px, 94vw);
  display: grid;
  grid-template-columns: 1fr 320px;
  gap: 18px;
  align-items: flex-start;
}

.game-card {
  background: rgba(255,255,255,0.6);
  border-radius: 12px;
  padding: 18px;
  box-shadow: 0 6px 30px rgba(0,0,0,0.25);
  display: flex;
  flex-direction: column;
  align-items: center;
}

.canvas-wrap {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
}

canvas {
  background: var(--bg-cream);
  border-radius: 12px;
  border: 4px solid #222;
  /* shadow luar lembut + inset */
  box-shadow:
    0 10px 24px rgba(0,0,0,0.18),
    0 4px 12px rgba(0,0,0,0.12),
    inset 0 4px 8px rgba(255,255,255,0.4);
  width: 100%;
  height: auto;
  max-width: 640px;
  display: block;
}

.hud {
  margin-top: 12px;
  width: 100%;
  max-width: 640px;
  display: flex;
  justify-content: space-between;
}

.badge {
  background: #eee;
  padding: 8px 14px;
  border-radius: 8px;
  font-weight: 600;
  color: #222;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
}

.panel {
  background: rgba(255,255,255,0.6);
  padding: 18px;
  border-radius: 12px;
  min-height: 240px;
}

    .panel {
      margin-left: 40px;
}

h1{font-size:18px;margin:0 0 8px 0}
p.muted{color:var(--muted);margin:6px 0 12px 0}

.controls{display:grid;grid-template-columns:1fr 1fr;gap:8px}
button{cursor:pointer;border:0;padding:10px;border-radius:8px;background:#000;color:#f5f5dc;font-weight:600}
button.primary{background:linear-gradient(90deg,#f5f0e6,#d8cfc0);color:#000}
.small{font-size:13px;padding:8px}
.footer{margin-top:12px;color:var(--muted);font-size:13px}
.touch-controls{display:flex;gap:8px;justify-content:center;margin-top:12px}
@media (max-width:900px){.wrap{grid-template-columns:1fr;}.panel{order:2}}
</style>

</head>
<body>
  <div class="wrap">
    <div class="game-card canvas-wrap">
      <h1>Rialo Snake</h1>
      <p class="muted">Controls: Arrow keys / WASD. On touch devices, use the D-Pad buttons.</p>
      <canvas id="game" width="640" height="480" aria-label="Rialo Snake"></canvas>
      <div class="hud">
        <div class="badge">Score: <span id="score">0</span></div>
        <div class="badge">High: <span id="high">0</span></div>
      </div>
      <div class="footer">Press <strong>Space</strong> to pause/resume. Press <strong>R</strong> to restart.</div>
      <div class="touch-controls" id="touchControls" style="display:none;">
        <button class="small" id="upBtn">▲</button>
        <div style="display:flex;flex-direction:column;gap:8px;align-items:center;">
          <button class="small" id="leftBtn">◀</button>
          <button class="small" id="rightBtn">▶</button>
        </div>
        <button class="small" id="downBtn">▼</button>
      </div>
    </div>

    <aside class="panel">
      <h2 style="margin:0 0 8px 0">Settings & Info</h2>
      <p class="muted">Eat the black fruit to grow. Avoid hitting walls (unless wrap-around enabled) or yourself.</p>
      <div style="margin-top:12px" class="controls">
        <div>
          <label class="muted">Speed</label>
          <input id="speed" type="range" min="4" max="18" value="8" style="width:100%">
        </div>
        <div>
          <label class="muted">Grid Size</label>
          <input id="gridSize" type="range" min="10" max="32" value="20" style="width:100%">
        </div>
      </div>

      <div style="margin-top:12px;display:flex;gap:8px;">
        <button id="startBtn" class="primary">Start / Resume</button>
        <button id="resetBtn">Restart</button>
      </div>

      <div style="margin-top:12px">
        <label style="display:flex;gap:8px;align-items:center" class="muted"><input id="wrapToggle" type="checkbox"> <span>Wrap-around walls</span></label>
      </div>

      <hr style="margin:12px 0;border:none;border-top:1px solid rgba(0,0,0,0.1)">
      <p class="muted">Tip: smaller grid = faster, harder game. High score is saved in localStorage.</p>
    </aside>
  </div>

  <script>
    (function(){
      const canvas = document.getElementById('game');
      const ctx = canvas.getContext('2d');
      const scoreEl = document.getElementById('score');
      const highEl = document.getElementById('high');
      const speedRange = document.getElementById('speed');
      const gridRange = document.getElementById('gridSize');
      const startBtn = document.getElementById('startBtn');
      const resetBtn = document.getElementById('resetBtn');
      const wrapToggle = document.getElementById('wrapToggle');
      const touchControls = document.getElementById('touchControls');

      let grid = parseInt(gridRange.value);
      let tileSize = 24;
      let rows, cols;
      let snake;
      let dir;
      let nextDir;
      let apple;
      let score=0;
      let high = parseInt(localStorage.getItem('snake_high')||0);
      highEl.textContent = high;
      let running=false;
      let gameLoopId=null;

      // load logo
      const logo = new Image();
      logo.src = "logo.png";
      let logoReady = false;
      logo.onload = ()=> logoReady=true;

      function resizeCanvas(){
        const maxW = Math.min(640, window.innerWidth*0.6);
        canvas.width = maxW;
        canvas.height = Math.round(maxW * 3/4);
        cols = grid;
        rows = Math.round((canvas.height / canvas.width) * cols);
        tileSize = Math.floor(canvas.width / cols);
      }

      function resetGame(){
        resizeCanvas();
        snake = [{x:Math.floor(cols/2), y:Math.floor(rows/2)}];
        dir = {x:1,y:0}; nextDir = null;
        placeApple();
        score = 0; scoreEl.textContent = score;
        if(gameLoopId) cancelAnimationFrame(gameLoopId);
        running=false;
        draw();
      }

      function placeApple(){
        while(true){
          const ax = Math.floor(Math.random()*cols);
          const ay = Math.floor(Math.random()*rows);
          if(!snake.some(s=>s.x===ax && s.y===ay)){ apple={x:ax,y:ay}; break; }
        }
      }

      function step(){
        if(!running) return;
        if(nextDir){
          if(!(nextDir.x === -dir.x && nextDir.y === -dir.y)) dir = nextDir;
          nextDir = null;
        }
        const head = {x:snake[0].x + dir.x, y:snake[0].y + dir.y};
        if(wrapToggle.checked){
          head.x = (head.x + cols) % cols;
          head.y = (head.y + rows) % rows;
        }
        if(!wrapToggle.checked){
          if(head.x<0 || head.x>=cols || head.y<0 || head.y>=rows){ return endGame(); }
        }
        if(snake.some(s=>s.x===head.x && s.y===head.y)) return endGame();

        snake.unshift(head);
        if(head.x===apple.x && head.y===apple.y){
          score += 10;
          scoreEl.textContent = score;
          placeApple();
        } else {
          snake.pop();
        }
        draw();
      }

      function draw(){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.fillStyle = '#f5f5dc'; // cream canvas
        ctx.fillRect(0,0,canvas.width,canvas.height);

        // draw apple (black ball)
        ctx.fillStyle = '#000';
        ctx.beginPath();
        ctx.arc((apple.x+0.5)*tileSize, (apple.y+0.5)*tileSize, tileSize/2.5, 0, Math.PI*2);
        ctx.fill();

        // draw snake with logo
        for(let i=0;i<snake.length;i++){
          const s = snake[i];
          const x = s.x*tileSize;
          const y = s.y*tileSize;
          if(logoReady){
            if(i===0){
              const scale=1.4;
              const offset=(tileSize*scale-tileSize)/2;
              ctx.drawImage(logo, x-offset, y-offset, tileSize*scale, tileSize*scale);
            }else{
              ctx.drawImage(logo, x, y, tileSize, tileSize);
            }
          } else {
            ctx.fillStyle = i===0 ? '#000' : '#444';
            ctx.fillRect(x,y,tileSize,tileSize);
          }
        }
      }

      function endGame(){
        running=false;
        cancelAnimationFrame(gameLoopId);
        if(score > high){ high = score; localStorage.setItem('snake_high', high); highEl.textContent = high; }
        ctx.fillStyle = 'rgba(255,0,0,0.2)';
        ctx.fillRect(0,0,canvas.width,canvas.height);
      }

      let lastTick=0;
      function loop(ts){
        if(!lastTick) lastTick=ts;
        const interval = 1000 / parseInt(speedRange.value);
        if(ts - lastTick > interval){ step(); lastTick = ts; }
        gameLoopId = requestAnimationFrame(loop);
      }

      window.addEventListener('keydown', e=>{
        const key = e.key.toLowerCase();
        if(['arrowup','w'].includes(key)) nextDir = {x:0,y:-1};
        else if(['arrowdown','s'].includes(key)) nextDir = {x:0,y:1};
        else if(['arrowleft','a'].includes(key)) nextDir = {x:-1,y:0};
        else if(['arrowright','d'].includes(key)) nextDir = {x:1,y:0};
        else if(key===' '){ running=!running; if(running) requestAnimationFrame(loop);}
        else if(key==='r'){ resetGame(); }
      });

      function showTouchIfNeeded(){
        const isTouch = 'ontouchstart' in window || navigator.maxTouchPoints>0;
        if(isTouch){ touchControls.style.display='flex'; }
      }
      document.getElementById('upBtn').addEventListener('click',()=> nextDir={x:0,y:-1});
      document.getElementById('downBtn').addEventListener('click',()=> nextDir={x:0,y:1});
      document.getElementById('leftBtn').addEventListener('click',()=> nextDir={x:-1,y:0});
      document.getElementById('rightBtn').addEventListener('click',()=> nextDir={x:1,y:0});

      startBtn.addEventListener('click',()=>{ if(!running){ running=true; requestAnimationFrame(loop);} });
      resetBtn.addEventListener('click',resetGame);
      gridRange.addEventListener('input',()=>{ grid=parseInt(gridRange.value); resetGame(); });

      window.addEventListener('resize', ()=>{ resizeCanvas(); draw(); });
      showTouchIfNeeded();
      resetGame();
      canvas.setAttribute('tabindex',0);
      canvas.addEventListener('click', ()=> canvas.focus());
    })();
  </script>
</body>
</html>
